{
    "id": "https://raw.githubusercontent.com/sdmx-twg/sdmx-json/develop/data-message/tools/schemas/1.0/sdmx-json-data-schema.json",
    "$schema": "http://json-schema.org/schema#",
    "description": "Schema for SDMX-JSON data message",
    "type": "object",
    "properties": {
        "meta": {"$ref": "#/definitions/meta"},
        "data": {
            "type": "object",
            "properties": {
                "dataStructureDefinitions": {
                    "type": ["null", "array"],
                    "items": {"$ref": "#/definitions/dataStructureDefinition"}
                },
                "metadataStructureDefinitions": {
                    "type": ["null", "array"],
                    "items": {"$ref": "#/definitions/metadataStructureDefinition"}
                },
                "categorySchemes": {
                    "type": ["null", "array"],
                    "items": {"$ref": "#/definitions/categorySchemes"}
                },
                "conceptSchemes": {
                    "type": ["null", "array"],
                    "items": {"$ref": "#/definitions/conceptScheme"}
                },
                "codelists": {
                    "type": ["null", "array"],
                    "items": {"$ref": "#/definitions/codelist"}
                },
                "hierarchicalCodelists": {
                    "type": ["null", "array"],
                    "items": {"$ref": "#/definitions/hierarchicalCodelist"}
                },
                "organisationsSchemes": {
                    "type": ["null", "array"],
                    "items": {"$ref": "#/definitions/organisationsScheme"}
                },
                "agencySchemes": {
                    "type": ["null", "array"],
                    "items": {"$ref": "#/definitions/agencyScheme"}
                },
                "dataProviderSchemes": {
                    "type": ["null", "array"],
                    "items": {"$ref": "#/definitions/dataProviderScheme"}
                },
                "dataConsumerSchemes": {
                    "type": ["null", "array"],
                    "items": {"$ref": "#/definitions/dataConsumerScheme"}
                },
                "organisationUnitSchemes": {
                    "type": ["null", "array"],
                    "items": {"$ref": "#/definitions/organisationUnitScheme"}
                },
                "dataflows": {
                    "type": ["null", "array"],
                    "items": {"$ref": "#/definitions/dataflow"}
                },
                "metadataflows": {
                    "type": ["null", "array"],
                    "items": {"$ref": "#/definitions/metadataflow"}
                },
                "reportingTaxonomies": {
                    "type": ["null", "array"],
                    "items": {"$ref": "#/definitions/reportingTaxonomy"}
                },
                "provisionAgreements": {
                    "type": ["null", "array"],
                    "items": {"$ref": "#/definitions/provisionAgreement"}
                },
                "structureSets": {
                    "type": ["null", "array"],
                    "items": {"$ref": "#/definitions/structureSet"}
                },
                "processes": {
                    "type": ["null", "array"],
                    "items": {"$ref": "#/definitions/process"}
                },
                "categorisations": {
                    "type": ["null", "array"],
                    "items": {"$ref": "#/definitions/categorisation"}
                },
                "constraints": {
                    "type": ["null", "array"],
                    "items": {"$ref": "#/definitions/constraint"}
                },
            }
        },
        "errors": {
            "type": [
                "null",
                "array"
            ],
            "items": {"$ref": "#/definitions/error"}
        }
    },
    "definitions": {
        "meta": {
            "type": "object",
            "required": [
                "id",
                "prepared",
                "sender"
            ],
            "properties": {
                "schema": {
                    "type": "string",
                    "format": "uri"
                },
                "id": {
                    "type": "string",
                    "pattern": "^[A-Za-z0-9_@$-]+$"
                },
                "test": {"type": [
                    "null",
                    "boolean"
                ]},
                "prepared": {
                    "type": "string",
                    "format": "date-time"
                },
                "content-languages": {"type": [
                        "null",
                        "array"
                    ],
                    "items": {"$ref": "#/definitions/content-language"}
                },
                "lang": {
                    "type": [
                        "null",
                        "string"
                    ],
                    "pattern": "^((?<grandfathered>(en-GB-oed|i-ami|i-bnn|i-default|i-enochian|i-hak|i-klingon|i-lux|i-mingo|i-navajo|i-pwn|i-tao|i-tay|i-tsu|sgn-BE-FR|sgn-BE-NL|sgn-CH-DE)|(art-lojban|cel-gaulish|no-bok|no-nyn|zh-guoyu|zh-hakka|zh-min|zh-min-nan|zh-xiang))|((?<language>([A-Za-z]{2,3}(-(?<extlang>[A-Za-z]{3}(-[A-Za-z]{3}){0,2}))?)|[A-Za-z]{4}|[A-Za-z]{5,8})(-(?<script>[A-Za-z]{4}))?(-(?<region>[A-Za-z]{2}|[0-9]{3}))?(-(?<variant>[A-Za-z0-9]{5,8}|[0-9][A-Za-z0-9]{3}))*(-(?<extension>[0-9A-WY-Za-wy-z](-[A-Za-z0-9]{2,8})+))*(-(?<privateUse>x(-[A-Za-z0-9]{1,8})+))?)|(?<privateUse>x(-[A-Za-z0-9]{1,8})+))$"
                }
                "sender": {"$ref": "#/definitions/party"},
                "receiver": {"$ref": "#/definitions/party"},
                "links": {
                    "type": [
                        "null",
                        "array"
                    ],
                    "items": {"$ref": "#/definitions/link"}
                }
            }
        },
        "party": {
            "type": "object",
            "required": ["id"],
            "properties": {
                "id": {
                    "type": "string",
                    "pattern": "^[A-Za-z0-9_@$-]+$"
                },
                "name": {"$ref": "#/definitions/name"},
                "contact": {
                    "type": [
                        "null",
                        "array"
                    ],
                    "items": {
                        "type": "object",
                        "required": ["name"],
                        "properties": {
                            "name": {"$ref": "#/definitions/name"},
                            "department": {"$ref": "#/definitions/name"},
                            "role": {"type": [
                                "null",
                                "string"
                            ]},
                            "telephone": {
                                "type": [
                                    "null",
                                    "array"
                                ],
                                "items": {"type": "string"}
                            },
                            "fax": {
                                "type": [
                                    "null",
                                    "array"
                                ],
                                "items": {"type": "string"}
                            },
                            "uri": {
                                "type": [
                                    "null",
                                    "array"
                                ],
                                "items": {
                                    "type": "string",
                                    "format": "uri"
                                }
                            },
                            "email": {
                                "type": [
                                    "null",
                                    "array"
                                ],
                                "items": {
                                    "type": "string",
                                    "format": "email"
                                }
                            }
                        }
                    }
                }
            }
        },
        "error": {
            "type": "object",
            "required": ["code"],
            "properties": {
                "code": {"type": "number"},
                "title": {"$ref": "#/definitions/name"},
                "detail": {"$ref": "#/definitions/name"},
                "links": {
                    "type": [
                        "null",
                        "array"
                    ],
                    "items": {"$ref": "#/definitions/link"}
                }
            }
        },
        "link": {
            "type": "object",
            "required": [
                "href",
                "rel"
            ],
            "properties": {
                "href": {
                    "type": "string",
                    "format": "uri"
                },
                "rel": {"type": "string"},
                "title": {"$ref": "#/definitions/name"},
                "type": {"type": [
                    "null",
                    "string"
                ]},
                "hreflang": {"type": [
                    "null",
                    "string"
                ]}
            }
        },
        "name": {
            "type": ["null", "object"],
            "patternProperties": {
                "^((?<grandfathered>(en-GB-oed|i-ami|i-bnn|i-default|i-enochian|i-hak|i-klingon|i-lux|i-mingo|i-navajo|i-pwn|i-tao|i-tay|i-tsu|sgn-BE-FR|sgn-BE-NL|sgn-CH-DE)|(art-lojban|cel-gaulish|no-bok|no-nyn|zh-guoyu|zh-hakka|zh-min|zh-min-nan|zh-xiang))|((?<language>([A-Za-z]{2,3}(-(?<extlang>[A-Za-z]{3}(-[A-Za-z]{3}){0,2}))?)|[A-Za-z]{4}|[A-Za-z]{5,8})(-(?<script>[A-Za-z]{4}))?(-(?<region>[A-Za-z]{2}|[0-9]{3}))?(-(?<variant>[A-Za-z0-9]{5,8}|[0-9][A-Za-z0-9]{3}))*(-(?<extension>[0-9A-WY-Za-wy-z](-[A-Za-z0-9]{2,8})+))*(-(?<privateUse>x(-[A-Za-z0-9]{1,8})+))?)|(?<privateUse>x(-[A-Za-z0-9]{1,8})+))$":
                  { "type": "string" }
            }
        },
        "content-language": {
            "type": ["object"],
            "required": ["lang"],
            "properties": {
                "lang": {
                    "type": "string",
                    "pattern": "^((?<grandfathered>(en-GB-oed|i-ami|i-bnn|i-default|i-enochian|i-hak|i-klingon|i-lux|i-mingo|i-navajo|i-pwn|i-tao|i-tay|i-tsu|sgn-BE-FR|sgn-BE-NL|sgn-CH-DE)|(art-lojban|cel-gaulish|no-bok|no-nyn|zh-guoyu|zh-hakka|zh-min|zh-min-nan|zh-xiang))|((?<language>([A-Za-z]{2,3}(-(?<extlang>[A-Za-z]{3}(-[A-Za-z]{3}){0,2}))?)|[A-Za-z]{4}|[A-Za-z]{5,8})(-(?<script>[A-Za-z]{4}))?(-(?<region>[A-Za-z]{2}|[0-9]{3}))?(-(?<variant>[A-Za-z0-9]{5,8}|[0-9][A-Za-z0-9]{3}))*(-(?<extension>[0-9A-WY-Za-wy-z](-[A-Za-z0-9]{2,8})+))*(-(?<privateUse>x(-[A-Za-z0-9]{1,8})+))?)|(?<privateUse>x(-[A-Za-z0-9]{1,8})+))$"
                },
                "q": {
                    "type": "number",
                    "minimum": 0.
                    "maximum": 1
                }
            }
        },
        "codelist" : {
            "allOf": [
                { "$ref": "#/definitions/maintainable" },
                { "properties": {
                        "codes": {"$ref": "#/definitions/codes"},
                        "isPartial": {
                            "type": [
                                "null",
                                 "boolean"
                            ]
                        }
                    }
                }
            ]
        },
        "codes": {
            "type": [
                "null",
                "array"
            ],
            "items": {
                "allOf": [
                    { "$ref": "#/definitions/namable" },
                    { "properties": {
                        "codes": {"$ref": "#/definitions/codes"},
                        "parent": {
                            "type": [
                                "null",
                                 "object"
                             ],
                             "required": ["id"],
                             "properties": {
                                  "id": {
                                       "type": "string",
                                       "pattern": "^[A-Za-z0-9_@$\-]+(\.[A-Za-z0-9_@$\-]+)*$"
                                  }
                             }
                        }
                    }}
                ]
            }
        },
        "maintainable": {
                "allOf": [
                    { "$ref": "#/definitions/namable" },
                    { "properties": {
                        "agencyID": { ... },
                        "isFinal": { ... },
                        "isExternalReference": { ... },
                        "version": { ... },
                        "validFrom": { ... },
                        "validTo": { ... }
                    }}
                ]
        }
        "namable": {
            // id, urn, uri, name, description, annotations
        }
    }
}
